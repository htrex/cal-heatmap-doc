!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("d3-selection"),require("d3")):"function"==typeof define&&define.amd?define(["d3-selection","d3"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).Legend=e(t.d3,t.d3)}(this,(function(t,e){"use strict";function n(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,r(o.key),o)}}function r(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}var o,i,a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},u=function(t){try{return!!t()}catch(t){return!0}},c=!u((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),s=!u((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),l=s,f=Function.prototype,p=f.call,d=l&&f.bind.bind(p,p),h=l?d:function(t){return function(){return p.apply(t,arguments)}},g=function(t){return null==t},m=g,y=TypeError,v=function(t){if(m(t))throw y("Can't call method on "+t);return t},b=v,w=Object,S=function(t){return w(b(t))},O=S,j=h({}.hasOwnProperty),P=Object.hasOwn||function(t,e){return j(O(t),e)},$=c,x=P,T=Function.prototype,k=$&&Object.getOwnPropertyDescriptor,E=x(T,"name"),R={EXISTS:E,PROPER:E&&"something"===function(){}.name,CONFIGURABLE:E&&(!$||$&&k(T,"name").configurable)},M={},C=function(t){return t&&t.Math==Math&&t},N=C("object"==typeof globalThis&&globalThis)||C("object"==typeof window&&window)||C("object"==typeof self&&self)||C("object"==typeof a&&a)||function(){return this}()||Function("return this")(),B="object"==typeof document&&document.all,q={all:B,IS_HTMLDDA:void 0===B&&void 0!==B},D=q.all,A=q.IS_HTMLDDA?function(t){return"function"==typeof t||t===D}:function(t){return"function"==typeof t},I=A,G=q.all,L=q.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:I(t)||t===G}:function(t){return"object"==typeof t?null!==t:I(t)},z=L,F=N.document,Y=z(F)&&z(F.createElement),_=function(t){return Y?F.createElement(t):{}},U=_,W=!c&&!u((function(){return 7!=Object.defineProperty(U("div"),"a",{get:function(){return 7}}).a})),H=c&&u((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),V=L,J=String,K=TypeError,X=function(t){if(V(t))return t;throw K(J(t)+" is not an object")},Z=s,Q=Function.prototype.call,tt=Z?Q.bind(Q):function(){return Q.apply(Q,arguments)},et=N,nt=A,rt=function(t){return nt(t)?t:void 0},ot=function(t,e){return arguments.length<2?rt(et[t]):et[t]&&et[t][e]},it=h({}.isPrototypeOf),at="undefined"!=typeof navigator&&String(navigator.userAgent)||"",ut=N,ct=at,st=ut.process,lt=ut.Deno,ft=st&&st.versions||lt&&lt.version,pt=ft&&ft.v8;pt&&(i=(o=pt.split("."))[0]>0&&o[0]<4?1:+(o[0]+o[1])),!i&&ct&&(!(o=ct.match(/Edge\/(\d+)/))||o[1]>=74)&&(o=ct.match(/Chrome\/(\d+)/))&&(i=+o[1]);var dt=i,ht=dt,gt=u,mt=!!Object.getOwnPropertySymbols&&!gt((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&ht&&ht<41})),yt=mt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,vt=ot,bt=A,wt=it,St=Object,Ot=yt?function(t){return"symbol"==typeof t}:function(t){var e=vt("Symbol");return bt(e)&&wt(e.prototype,St(t))},jt=String,Pt=function(t){try{return jt(t)}catch(t){return"Object"}},$t=A,xt=Pt,Tt=TypeError,kt=function(t){if($t(t))return t;throw Tt(xt(t)+" is not a function")},Et=kt,Rt=g,Mt=function(t,e){var n=t[e];return Rt(n)?void 0:Et(n)},Ct=tt,Nt=A,Bt=L,qt=TypeError,Dt={},At={get exports(){return Dt},set exports(t){Dt=t}},It=N,Gt=Object.defineProperty,Lt=function(t,e){try{Gt(It,t,{value:e,configurable:!0,writable:!0})}catch(n){It[t]=e}return e},zt=Lt,Ft="__core-js_shared__",Yt=N[Ft]||zt(Ft,{}),_t=Yt;(At.exports=function(t,e){return _t[t]||(_t[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.27.2",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.27.2/LICENSE",source:"https://github.com/zloirock/core-js"});var Ut=h,Wt=0,Ht=Math.random(),Vt=Ut(1..toString),Jt=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Vt(++Wt+Ht,36)},Kt=Dt,Xt=P,Zt=Jt,Qt=mt,te=yt,ee=N.Symbol,ne=Kt("wks"),re=te?ee.for||ee:ee&&ee.withoutSetter||Zt,oe=function(t){return Xt(ne,t)||(ne[t]=Qt&&Xt(ee,t)?ee[t]:re("Symbol."+t)),ne[t]},ie=tt,ae=L,ue=Ot,ce=Mt,se=function(t,e){var n,r;if("string"===e&&Nt(n=t.toString)&&!Bt(r=Ct(n,t)))return r;if(Nt(n=t.valueOf)&&!Bt(r=Ct(n,t)))return r;if("string"!==e&&Nt(n=t.toString)&&!Bt(r=Ct(n,t)))return r;throw qt("Can't convert object to primitive value")},le=TypeError,fe=oe("toPrimitive"),pe=function(t,e){if(!ae(t)||ue(t))return t;var n,r=ce(t,fe);if(r){if(void 0===e&&(e="default"),n=ie(r,t,e),!ae(n)||ue(n))return n;throw le("Can't convert object to primitive value")}return void 0===e&&(e="number"),se(t,e)},de=Ot,he=function(t){var e=pe(t,"string");return de(e)?e:e+""},ge=c,me=W,ye=H,ve=X,be=he,we=TypeError,Se=Object.defineProperty,Oe=Object.getOwnPropertyDescriptor,je="enumerable",Pe="configurable",$e="writable";M.f=ge?ye?function(t,e,n){if(ve(t),e=be(e),ve(n),"function"==typeof t&&"prototype"===e&&"value"in n&&$e in n&&!n[$e]){var r=Oe(t,e);r&&r[$e]&&(t[e]=n.value,n={configurable:Pe in n?n[Pe]:r[Pe],enumerable:je in n?n[je]:r[je],writable:!1})}return Se(t,e,n)}:Se:function(t,e,n){if(ve(t),e=be(e),ve(n),me)try{return Se(t,e,n)}catch(t){}if("get"in n||"set"in n)throw we("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var xe=c,Te=R.EXISTS,ke=h,Ee=M.f,Re=Function.prototype,Me=ke(Re.toString),Ce=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,Ne=ke(Ce.exec);xe&&!Te&&Ee(Re,"name",{configurable:!0,get:function(){try{return Ne(Ce,Me(this))[1]}catch(t){return""}}});var Be={},qe={},De={}.propertyIsEnumerable,Ae=Object.getOwnPropertyDescriptor,Ie=Ae&&!De.call({1:2},1);qe.f=Ie?function(t){var e=Ae(this,t);return!!e&&e.enumerable}:De;var Ge=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},Le=h,ze=Le({}.toString),Fe=Le("".slice),Ye=function(t){return Fe(ze(t),8,-1)},_e=u,Ue=Ye,We=Object,He=h("".split),Ve=_e((function(){return!We("z").propertyIsEnumerable(0)}))?function(t){return"String"==Ue(t)?He(t,""):We(t)}:We,Je=Ve,Ke=v,Xe=function(t){return Je(Ke(t))},Ze=c,Qe=tt,tn=qe,en=Ge,nn=Xe,rn=he,on=P,an=W,un=Object.getOwnPropertyDescriptor;Be.f=Ze?un:function(t,e){if(t=nn(t),e=rn(e),an)try{return un(t,e)}catch(t){}if(on(t,e))return en(!Qe(tn.f,t,e),t[e])};var cn=M,sn=Ge,ln=c?function(t,e,n){return cn.f(t,e,sn(1,n))}:function(t,e,n){return t[e]=n,t},fn={},pn={get exports(){return fn},set exports(t){fn=t}},dn=A,hn=Yt,gn=h(Function.toString);dn(hn.inspectSource)||(hn.inspectSource=function(t){return gn(t)});var mn,yn,vn,bn=hn.inspectSource,wn=A,Sn=N.WeakMap,On=wn(Sn)&&/native code/.test(String(Sn)),jn=Jt,Pn=Dt("keys"),$n={},xn=On,Tn=N,kn=L,En=ln,Rn=P,Mn=Yt,Cn=function(t){return Pn[t]||(Pn[t]=jn(t))},Nn=$n,Bn="Object already initialized",qn=Tn.TypeError,Dn=Tn.WeakMap;if(xn||Mn.state){var An=Mn.state||(Mn.state=new Dn);An.get=An.get,An.has=An.has,An.set=An.set,mn=function(t,e){if(An.has(t))throw qn(Bn);return e.facade=t,An.set(t,e),e},yn=function(t){return An.get(t)||{}},vn=function(t){return An.has(t)}}else{var In=Cn("state");Nn[In]=!0,mn=function(t,e){if(Rn(t,In))throw qn(Bn);return e.facade=t,En(t,In,e),e},yn=function(t){return Rn(t,In)?t[In]:{}},vn=function(t){return Rn(t,In)}}var Gn={set:mn,get:yn,has:vn,enforce:function(t){return vn(t)?yn(t):mn(t,{})},getterFor:function(t){return function(e){var n;if(!kn(e)||(n=yn(e)).type!==t)throw qn("Incompatible receiver, "+t+" required");return n}}},Ln=h,zn=u,Fn=A,Yn=P,_n=c,Un=R.CONFIGURABLE,Wn=bn,Hn=Gn.enforce,Vn=Gn.get,Jn=String,Kn=Object.defineProperty,Xn=Ln("".slice),Zn=Ln("".replace),Qn=Ln([].join),tr=_n&&!zn((function(){return 8!==Kn((function(){}),"length",{value:8}).length})),er=String(String).split("String"),nr=pn.exports=function(t,e,n){"Symbol("===Xn(Jn(e),0,7)&&(e="["+Zn(Jn(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Yn(t,"name")||Un&&t.name!==e)&&(_n?Kn(t,"name",{value:e,configurable:!0}):t.name=e),tr&&n&&Yn(n,"arity")&&t.length!==n.arity&&Kn(t,"length",{value:n.arity});try{n&&Yn(n,"constructor")&&n.constructor?_n&&Kn(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=Hn(t);return Yn(r,"source")||(r.source=Qn(er,"string"==typeof e?e:"")),t};Function.prototype.toString=nr((function(){return Fn(this)&&Vn(this).source||Wn(this)}),"toString");var rr=A,or=M,ir=fn,ar=Lt,ur=function(t,e,n,r){r||(r={});var o=r.enumerable,i=void 0!==r.name?r.name:e;if(rr(n)&&ir(n,i,r),r.global)o?t[e]=n:ar(e,n);else{try{r.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=n:or.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},cr={},sr=Math.ceil,lr=Math.floor,fr=Math.trunc||function(t){var e=+t;return(e>0?lr:sr)(e)},pr=function(t){var e=+t;return e!=e||0===e?0:fr(e)},dr=pr,hr=Math.max,gr=Math.min,mr=pr,yr=Math.min,vr=function(t){return t>0?yr(mr(t),9007199254740991):0},br=function(t){return vr(t.length)},wr=Xe,Sr=function(t,e){var n=dr(t);return n<0?hr(n+e,0):gr(n,e)},Or=br,jr=function(t){return function(e,n,r){var o,i=wr(e),a=Or(i),u=Sr(r,a);if(t&&n!=n){for(;a>u;)if((o=i[u++])!=o)return!0}else for(;a>u;u++)if((t||u in i)&&i[u]===n)return t||u||0;return!t&&-1}},Pr={includes:jr(!0),indexOf:jr(!1)},$r=P,xr=Xe,Tr=Pr.indexOf,kr=$n,Er=h([].push),Rr=function(t,e){var n,r=xr(t),o=0,i=[];for(n in r)!$r(kr,n)&&$r(r,n)&&Er(i,n);for(;e.length>o;)$r(r,n=e[o++])&&(~Tr(i,n)||Er(i,n));return i},Mr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Cr=Rr,Nr=Mr.concat("length","prototype");cr.f=Object.getOwnPropertyNames||function(t){return Cr(t,Nr)};var Br={};Br.f=Object.getOwnPropertySymbols;var qr=ot,Dr=cr,Ar=Br,Ir=X,Gr=h([].concat),Lr=qr("Reflect","ownKeys")||function(t){var e=Dr.f(Ir(t)),n=Ar.f;return n?Gr(e,n(t)):e},zr=P,Fr=Lr,Yr=Be,_r=M,Ur=u,Wr=A,Hr=/#|\.prototype\./,Vr=function(t,e){var n=Kr[Jr(t)];return n==Zr||n!=Xr&&(Wr(e)?Ur(e):!!e)},Jr=Vr.normalize=function(t){return String(t).replace(Hr,".").toLowerCase()},Kr=Vr.data={},Xr=Vr.NATIVE="N",Zr=Vr.POLYFILL="P",Qr=Vr,to=N,eo=Be.f,no=ln,ro=ur,oo=Lt,io=function(t,e,n){for(var r=Fr(e),o=_r.f,i=Yr.f,a=0;a<r.length;a++){var u=r[a];zr(t,u)||n&&zr(n,u)||o(t,u,i(e,u))}},ao=Qr,uo=function(t,e){var n,r,o,i,a,u=t.target,c=t.global,s=t.stat;if(n=c?to:s?to[u]||oo(u,{}):(to[u]||{}).prototype)for(r in e){if(i=e[r],o=t.dontCallGetSet?(a=eo(n,r))&&a.value:n[r],!ao(c?r:u+(s?".":"#")+r,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;io(i,o)}(t.sham||o&&o.sham)&&no(i,"sham",!0),ro(n,r,i,t)}},co=Rr,so=Mr,lo=Object.keys||function(t){return co(t,so)},fo=c,po=h,ho=tt,go=u,mo=lo,yo=Br,vo=qe,bo=S,wo=Ve,So=Object.assign,Oo=Object.defineProperty,jo=po([].concat),Po=!So||go((function(){if(fo&&1!==So({b:1},So(Oo({},"a",{enumerable:!0,get:function(){Oo(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach((function(t){e[t]=t})),7!=So({},t)[n]||mo(So({},e)).join("")!=r}))?function(t,e){for(var n=bo(t),r=arguments.length,o=1,i=yo.f,a=vo.f;r>o;)for(var u,c=wo(arguments[o++]),s=i?jo(mo(c),i(c)):mo(c),l=s.length,f=0;l>f;)u=s[f++],fo&&!ho(a,c,u)||(n[u]=c[u]);return n}:So,$o=Po;uo({target:"Object",stat:!0,arity:2,forced:Object.assign!==$o},{assign:$o});var xo={};xo[oe("toStringTag")]="z";var To="[object z]"===String(xo),ko=To,Eo=A,Ro=Ye,Mo=oe("toStringTag"),Co=Object,No="Arguments"==Ro(function(){return arguments}()),Bo=ko?Ro:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Co(t),Mo))?n:No?Ro(e):"Object"==(r=Ro(e))&&Eo(e.callee)?"Arguments":r},qo=Bo,Do=To?{}.toString:function(){return"[object "+qo(this)+"]"};To||ur(Object.prototype,"toString",Do,{unsafe:!0});var Ao="undefined"!=typeof process&&"process"==Ye(process),Io=A,Go=String,Lo=TypeError,zo=h,Fo=X,Yo=function(t){if("object"==typeof t||Io(t))return t;throw Lo("Can't set "+Go(t)+" as a prototype")},_o=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=zo(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return Fo(n),Yo(r),e?t(n,r):n.__proto__=r,n}}():void 0),Uo=M.f,Wo=P,Ho=oe("toStringTag"),Vo=ot,Jo=M,Ko=c,Xo=oe("species"),Zo=it,Qo=TypeError,ti=h,ei=u,ni=A,ri=Bo,oi=bn,ii=function(){},ai=[],ui=ot("Reflect","construct"),ci=/^\s*(?:class|function)\b/,si=ti(ci.exec),li=!ci.exec(ii),fi=function(t){if(!ni(t))return!1;try{return ui(ii,ai,t),!0}catch(t){return!1}},pi=function(t){if(!ni(t))return!1;switch(ri(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return li||!!si(ci,oi(t))}catch(t){return!0}};pi.sham=!0;var di,hi,gi,mi,yi=!ui||ei((function(){var t;return fi(fi.call)||!fi(Object)||!fi((function(){t=!0}))||t}))?pi:fi,vi=yi,bi=Pt,wi=TypeError,Si=X,Oi=function(t){if(vi(t))return t;throw wi(bi(t)+" is not a constructor")},ji=g,Pi=oe("species"),$i=s,xi=Function.prototype,Ti=xi.apply,ki=xi.call,Ei="object"==typeof Reflect&&Reflect.apply||($i?ki.bind(Ti):function(){return ki.apply(Ti,arguments)}),Ri=Ye,Mi=h,Ci=function(t){if("Function"===Ri(t))return Mi(t)},Ni=kt,Bi=s,qi=Ci(Ci.bind),Di=function(t,e){return Ni(t),void 0===e?t:Bi?qi(t,e):function(){return t.apply(e,arguments)}},Ai=ot("document","documentElement"),Ii=h([].slice),Gi=TypeError,Li=/(?:ipad|iphone|ipod).*applewebkit/i.test(at),zi=N,Fi=Ei,Yi=Di,_i=A,Ui=P,Wi=u,Hi=Ai,Vi=Ii,Ji=_,Ki=function(t,e){if(t<e)throw Gi("Not enough arguments");return t},Xi=Li,Zi=Ao,Qi=zi.setImmediate,ta=zi.clearImmediate,ea=zi.process,na=zi.Dispatch,ra=zi.Function,oa=zi.MessageChannel,ia=zi.String,aa=0,ua={},ca="onreadystatechange";Wi((function(){di=zi.location}));var sa=function(t){if(Ui(ua,t)){var e=ua[t];delete ua[t],e()}},la=function(t){return function(){sa(t)}},fa=function(t){sa(t.data)},pa=function(t){zi.postMessage(ia(t),di.protocol+"//"+di.host)};Qi&&ta||(Qi=function(t){Ki(arguments.length,1);var e=_i(t)?t:ra(t),n=Vi(arguments,1);return ua[++aa]=function(){Fi(e,void 0,n)},hi(aa),aa},ta=function(t){delete ua[t]},Zi?hi=function(t){ea.nextTick(la(t))}:na&&na.now?hi=function(t){na.now(la(t))}:oa&&!Xi?(mi=(gi=new oa).port2,gi.port1.onmessage=fa,hi=Yi(mi.postMessage,mi)):zi.addEventListener&&_i(zi.postMessage)&&!zi.importScripts&&di&&"file:"!==di.protocol&&!Wi(pa)?(hi=pa,zi.addEventListener("message",fa,!1)):hi=ca in Ji("script")?function(t){Hi.appendChild(Ji("script"))[ca]=function(){Hi.removeChild(this),sa(t)}}:function(t){setTimeout(la(t),0)});var da={set:Qi,clear:ta},ha=function(){this.head=null,this.tail=null};ha.prototype={add:function(t){var e={item:t,next:null},n=this.tail;n?n.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}};var ga,ma,ya,va,ba,wa=ha,Sa=/ipad|iphone|ipod/i.test(at)&&"undefined"!=typeof Pebble,Oa=/web0s(?!.*chrome)/i.test(at),ja=N,Pa=Di,$a=Be.f,xa=da.set,Ta=wa,ka=Li,Ea=Sa,Ra=Oa,Ma=Ao,Ca=ja.MutationObserver||ja.WebKitMutationObserver,Na=ja.document,Ba=ja.process,qa=ja.Promise,Da=$a(ja,"queueMicrotask"),Aa=Da&&Da.value;if(!Aa){var Ia=new Ta,Ga=function(){var t,e;for(Ma&&(t=Ba.domain)&&t.exit();e=Ia.get();)try{e()}catch(t){throw Ia.head&&ga(),t}t&&t.enter()};ka||Ma||Ra||!Ca||!Na?!Ea&&qa&&qa.resolve?((va=qa.resolve(void 0)).constructor=qa,ba=Pa(va.then,va),ga=function(){ba(Ga)}):Ma?ga=function(){Ba.nextTick(Ga)}:(xa=Pa(xa,ja),ga=function(){xa(Ga)}):(ma=!0,ya=Na.createTextNode(""),new Ca(Ga).observe(ya,{characterData:!0}),ga=function(){ya.data=ma=!ma}),Aa=function(t){Ia.head||ga(),Ia.add(t)}}var La=Aa,za=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},Fa=N.Promise,Ya="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,_a=!Ya&&!Ao&&"object"==typeof window&&"object"==typeof document,Ua=N,Wa=Fa,Ha=A,Va=Qr,Ja=bn,Ka=oe,Xa=_a,Za=Ya,Qa=dt;Wa&&Wa.prototype;var tu=Ka("species"),eu=!1,nu=Ha(Ua.PromiseRejectionEvent),ru=Va("Promise",(function(){var t=Ja(Wa),e=t!==String(Wa);if(!e&&66===Qa)return!0;if(!Qa||Qa<51||!/native code/.test(t)){var n=new Wa((function(t){t(1)})),r=function(t){t((function(){}),(function(){}))};if((n.constructor={})[tu]=r,!(eu=n.then((function(){}))instanceof r))return!0}return!e&&(Xa||Za)&&!nu})),ou={CONSTRUCTOR:ru,REJECTION_EVENT:nu,SUBCLASSING:eu},iu={},au=kt,uu=TypeError,cu=function(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw uu("Bad Promise constructor");e=t,n=r})),this.resolve=au(e),this.reject=au(n)};iu.f=function(t){return new cu(t)};var su,lu,fu,pu=uo,du=Ao,hu=N,gu=tt,mu=ur,yu=_o,vu=function(t,e,n){t&&!n&&(t=t.prototype),t&&!Wo(t,Ho)&&Uo(t,Ho,{configurable:!0,value:e})},bu=function(t){var e=Vo(t),n=Jo.f;Ko&&e&&!e[Xo]&&n(e,Xo,{configurable:!0,get:function(){return this}})},wu=kt,Su=A,Ou=L,ju=function(t,e){if(Zo(e,t))return t;throw Qo("Incorrect invocation")},Pu=function(t,e){var n,r=Si(t).constructor;return void 0===r||ji(n=Si(r)[Pi])?e:Oi(n)},$u=da.set,xu=La,Tu=function(t,e){try{1==arguments.length?console.error(t):console.error(t,e)}catch(t){}},ku=za,Eu=wa,Ru=Gn,Mu=Fa,Cu=iu,Nu="Promise",Bu=ou.CONSTRUCTOR,qu=ou.REJECTION_EVENT,Du=ou.SUBCLASSING,Au=Ru.getterFor(Nu),Iu=Ru.set,Gu=Mu&&Mu.prototype,Lu=Mu,zu=Gu,Fu=hu.TypeError,Yu=hu.document,_u=hu.process,Uu=Cu.f,Wu=Uu,Hu=!!(Yu&&Yu.createEvent&&hu.dispatchEvent),Vu="unhandledrejection",Ju=function(t){var e;return!(!Ou(t)||!Su(e=t.then))&&e},Ku=function(t,e){var n,r,o,i=e.value,a=1==e.state,u=a?t.ok:t.fail,c=t.resolve,s=t.reject,l=t.domain;try{u?(a||(2===e.rejection&&ec(e),e.rejection=1),!0===u?n=i:(l&&l.enter(),n=u(i),l&&(l.exit(),o=!0)),n===t.promise?s(Fu("Promise-chain cycle")):(r=Ju(n))?gu(r,n,c,s):c(n)):s(i)}catch(t){l&&!o&&l.exit(),s(t)}},Xu=function(t,e){t.notified||(t.notified=!0,xu((function(){for(var n,r=t.reactions;n=r.get();)Ku(n,t);t.notified=!1,e&&!t.rejection&&Qu(t)})))},Zu=function(t,e,n){var r,o;Hu?((r=Yu.createEvent("Event")).promise=e,r.reason=n,r.initEvent(t,!1,!0),hu.dispatchEvent(r)):r={promise:e,reason:n},!qu&&(o=hu["on"+t])?o(r):t===Vu&&Tu("Unhandled promise rejection",n)},Qu=function(t){gu($u,hu,(function(){var e,n=t.facade,r=t.value;if(tc(t)&&(e=ku((function(){du?_u.emit("unhandledRejection",r,n):Zu(Vu,n,r)})),t.rejection=du||tc(t)?2:1,e.error))throw e.value}))},tc=function(t){return 1!==t.rejection&&!t.parent},ec=function(t){gu($u,hu,(function(){var e=t.facade;du?_u.emit("rejectionHandled",e):Zu("rejectionhandled",e,t.value)}))},nc=function(t,e,n){return function(r){t(e,r,n)}},rc=function(t,e,n){t.done||(t.done=!0,n&&(t=n),t.value=e,t.state=2,Xu(t,!0))},oc=function(t,e,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===e)throw Fu("Promise can't be resolved itself");var r=Ju(e);r?xu((function(){var n={done:!1};try{gu(r,e,nc(oc,n,t),nc(rc,n,t))}catch(e){rc(n,e,t)}})):(t.value=e,t.state=1,Xu(t,!1))}catch(e){rc({done:!1},e,t)}}};if(Bu&&(zu=(Lu=function(t){ju(this,zu),wu(t),gu(su,this);var e=Au(this);try{t(nc(oc,e),nc(rc,e))}catch(t){rc(e,t)}}).prototype,(su=function(t){Iu(this,{type:Nu,done:!1,notified:!1,parent:!1,reactions:new Eu,rejection:!1,state:0,value:void 0})}).prototype=mu(zu,"then",(function(t,e){var n=Au(this),r=Uu(Pu(this,Lu));return n.parent=!0,r.ok=!Su(t)||t,r.fail=Su(e)&&e,r.domain=du?_u.domain:void 0,0==n.state?n.reactions.add(r):xu((function(){Ku(r,n)})),r.promise})),lu=function(){var t=new su,e=Au(t);this.promise=t,this.resolve=nc(oc,e),this.reject=nc(rc,e)},Cu.f=Uu=function(t){return t===Lu||undefined===t?new lu(t):Wu(t)},Su(Mu)&&Gu!==Object.prototype)){fu=Gu.then,Du||mu(Gu,"then",(function(t,e){var n=this;return new Lu((function(t,e){gu(fu,n,t,e)})).then(t,e)}),{unsafe:!0});try{delete Gu.constructor}catch(t){}yu&&yu(Gu,zu)}pu({global:!0,constructor:!0,wrap:!0,forced:Bu},{Promise:Lu}),vu(Lu,Nu,!1),bu(Nu);var ic={},ac=ic,uc=oe("iterator"),cc=Array.prototype,sc=Bo,lc=Mt,fc=g,pc=ic,dc=oe("iterator"),hc=function(t){if(!fc(t))return lc(t,dc)||lc(t,"@@iterator")||pc[sc(t)]},gc=tt,mc=kt,yc=X,vc=Pt,bc=hc,wc=TypeError,Sc=tt,Oc=X,jc=Mt,Pc=Di,$c=tt,xc=X,Tc=Pt,kc=function(t){return void 0!==t&&(ac.Array===t||cc[uc]===t)},Ec=br,Rc=it,Mc=function(t,e){var n=arguments.length<2?bc(t):e;if(mc(n))return yc(gc(n,t));throw wc(vc(t)+" is not iterable")},Cc=hc,Nc=function(t,e,n){var r,o;Oc(t);try{if(!(r=jc(t,"return"))){if("throw"===e)throw n;return n}r=Sc(r,t)}catch(t){o=!0,r=t}if("throw"===e)throw n;if(o)throw r;return Oc(r),n},Bc=TypeError,qc=function(t,e){this.stopped=t,this.result=e},Dc=qc.prototype,Ac=function(t,e,n){var r,o,i,a,u,c,s,l=n&&n.that,f=!(!n||!n.AS_ENTRIES),p=!(!n||!n.IS_RECORD),d=!(!n||!n.IS_ITERATOR),h=!(!n||!n.INTERRUPTED),g=Pc(e,l),m=function(t){return r&&Nc(r,"normal",t),new qc(!0,t)},y=function(t){return f?(xc(t),h?g(t[0],t[1],m):g(t[0],t[1])):h?g(t,m):g(t)};if(p)r=t.iterator;else if(d)r=t;else{if(!(o=Cc(t)))throw Bc(Tc(t)+" is not iterable");if(kc(o)){for(i=0,a=Ec(t);a>i;i++)if((u=y(t[i]))&&Rc(Dc,u))return u;return new qc(!1)}r=Mc(t,o)}for(c=p?t.next:r.next;!(s=$c(c,r)).done;){try{u=y(s.value)}catch(t){Nc(r,"throw",t)}if("object"==typeof u&&u&&Rc(Dc,u))return u}return new qc(!1)},Ic=oe("iterator"),Gc=!1;try{var Lc=0,zc={next:function(){return{done:!!Lc++}},return:function(){Gc=!0}};zc[Ic]=function(){return this},Array.from(zc,(function(){throw 2}))}catch(t){}var Fc=Fa,Yc=function(t,e){if(!e&&!Gc)return!1;var n=!1;try{var r={};r[Ic]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(t){}return n},_c=ou.CONSTRUCTOR||!Yc((function(t){Fc.all(t).then(void 0,(function(){}))})),Uc=tt,Wc=kt,Hc=iu,Vc=za,Jc=Ac;uo({target:"Promise",stat:!0,forced:_c},{all:function(t){var e=this,n=Hc.f(e),r=n.resolve,o=n.reject,i=Vc((function(){var n=Wc(e.resolve),i=[],a=0,u=1;Jc(t,(function(t){var c=a++,s=!1;u++,Uc(n,e,t).then((function(t){s||(s=!0,i[c]=t,--u||r(i))}),o)})),--u||r(i)}));return i.error&&o(i.value),n.promise}});var Kc=uo,Xc=ou.CONSTRUCTOR,Zc=Fa,Qc=ot,ts=A,es=ur,ns=Zc&&Zc.prototype;if(Kc({target:"Promise",proto:!0,forced:Xc,real:!0},{catch:function(t){return this.then(void 0,t)}}),ts(Zc)){var rs=Qc("Promise").prototype.catch;ns.catch!==rs&&es(ns,"catch",rs,{unsafe:!0})}var os=tt,is=kt,as=iu,us=za,cs=Ac;uo({target:"Promise",stat:!0,forced:_c},{race:function(t){var e=this,n=as.f(e),r=n.reject,o=us((function(){var o=is(e.resolve);cs(t,(function(t){os(o,e,t).then(n.resolve,r)}))}));return o.error&&r(o.value),n.promise}});var ss=tt,ls=iu;uo({target:"Promise",stat:!0,forced:ou.CONSTRUCTOR},{reject:function(t){var e=ls.f(this);return ss(e.reject,void 0,t),e.promise}});var fs=X,ps=L,ds=iu,hs=uo,gs=ou.CONSTRUCTOR,ms=function(t,e){if(fs(t),ps(e)&&e.constructor===t)return e;var n=ds.f(t);return(0,n.resolve)(e),n.promise};function ys(t,e){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return"function"==typeof e?e(t):e;const n=t.getUTCHours(),r=t.getUTCMinutes(),o=t.getUTCSeconds(),i=t.getUTCMilliseconds();return`${a=t.getUTCFullYear(),a<0?`-${vs(-a,6)}`:a>9999?`+${vs(a,6)}`:vs(a,4)}-${vs(t.getUTCMonth()+1,2)}-${vs(t.getUTCDate(),2)}${n||r||o||i?`T${vs(n,2)}:${vs(r,2)}${o||i?`:${vs(o,2)}${i?`.${vs(i,3)}`:""}`:""}Z`:""}`;var a}function vs(t,e){return`${t}`.padStart(e,"0")}ot("Promise"),hs({target:"Promise",stat:!0,forced:gs},{resolve:function(t){return ms(this,t)}});const bs=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function ws(t,e){return bs.test(t+="")?new Date(t):"function"==typeof e?e(t):e}const Ss=new Map([["second",e.utcSecond],["minute",e.utcMinute],["hour",e.utcHour],["day",e.utcDay],["week",e.utcWeek],["month",e.utcMonth],["year",e.utcYear],["monday",e.utcMonday],["tuesday",e.utcTuesday],["wednesday",e.utcWednesday],["thursday",e.utcThursday],["friday",e.utcFriday],["saturday",e.utcSaturday],["sunday",e.utcSunday]]);const Os=Object.getPrototypeOf(Uint8Array),js=Object.prototype.toString,Ps=t=>null==t?t:`${t}`,$s=t=>()=>t;function xs(t,e){return void 0===t&&(t=e),null===t?[void 0,"none"]:Gs(t)?[void 0,t]:[t,void 0]}function Ts(t,e){return void 0===t&&(t=e),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function ks(t,e){return null==t?t:void 0===e?t instanceof Array||t instanceof Os?t:Array.from(t):t instanceof e?t:e.from(t)}function Es(t,e,n=Array){return t instanceof n?t.map(e):n.from(t,e)}function Rs(t){return t?.toString===js}function Ms(t){return Rs(t)&&(void 0!==t.type||void 0!==t.domain)}function Cs(t){if(null!=t){if("number"==typeof t){const n=t;return{floor:t=>n*Math.floor(t/n),offset:t=>t+n,range:(t,r)=>e.range(Math.ceil(t/n),r/n).map((t=>n*t))}}if("string"==typeof t)return function(t){const e=Ss.get(`${t}`.toLowerCase());if(!e)throw new Error(`unknown interval: ${t}`);return e}(t);if("function"!=typeof t.floor)throw new Error("invalid interval; missing floor method");if("function"!=typeof t.offset)throw new Error("invalid interval; missing offset method");return t}}function Ns(t){for(const e of t){if(null==e)continue;const t=typeof e;return"string"===t||"boolean"===t}}function Bs(t){for(const e of t)if(null!=e)return e instanceof Date}function qs(t){for(const e of t)if(null!=e)return"string"==typeof e&&isNaN(e)&&ws(e)}function Ds(t){for(const e of t)if(null!=e){if("string"!=typeof e)return!1;if(e.trim())return!isNaN(e)}}function As(t,e){for(const n of t)if(null!=n)return e(n)}function Is(t,e){for(const n of t)if(null!=n&&!e(n))return!1;return!0}function Gs(t){return"string"==typeof t&&("none"===(t=t.toLowerCase().trim())||"currentcolor"===t||t.startsWith("url(")&&t.endsWith(")")||t.startsWith("var(")&&t.endsWith(")")||null!==e.color(t))}function Ls(t){return null==t||function(t){return/^\s*none\s*$/i.test(t)}(t)}function zs(t){if(null==t)return;const n=t[0],r=t[t.length-1];return e.descending(n,r)}const Fs=Symbol("position"),Ys=Symbol("color"),_s=Symbol("radius"),Us=Symbol("length"),Ws=Symbol("opacity"),Hs=Symbol("symbol"),Vs=new Map([["x",Fs],["y",Fs],["fx",Fs],["fy",Fs],["r",_s],["color",Ys],["opacity",Ws],["symbol",Hs],["length",Us]]);function Js(t){return null!=t&&!Number.isNaN(t)}function Ks(t,n){return+Js(n)-+Js(t)||e.ascending(t,n)}function Xs(t){return isFinite(t)?t:NaN}function Zs(t){return t>0&&isFinite(t)?t:NaN}function Qs(t){return t<0&&isFinite(t)?t:NaN}const tl=new Map([["accent",e.schemeAccent],["category10",e.schemeCategory10],["dark2",e.schemeDark2],["paired",e.schemePaired],["pastel1",e.schemePastel1],["pastel2",e.schemePastel2],["set1",e.schemeSet1],["set2",e.schemeSet2],["set3",e.schemeSet3],["tableau10",e.schemeTableau10],["brbg",nl(e.schemeBrBG,e.interpolateBrBG)],["prgn",nl(e.schemePRGn,e.interpolatePRGn)],["piyg",nl(e.schemePiYG,e.interpolatePiYG)],["puor",nl(e.schemePuOr,e.interpolatePuOr)],["rdbu",nl(e.schemeRdBu,e.interpolateRdBu)],["rdgy",nl(e.schemeRdGy,e.interpolateRdGy)],["rdylbu",nl(e.schemeRdYlBu,e.interpolateRdYlBu)],["rdylgn",nl(e.schemeRdYlGn,e.interpolateRdYlGn)],["spectral",nl(e.schemeSpectral,e.interpolateSpectral)],["burd",rl(e.schemeRdBu,e.interpolateRdBu)],["buylrd",rl(e.schemeRdYlBu,e.interpolateRdYlBu)],["blues",el(e.schemeBlues,e.interpolateBlues)],["greens",el(e.schemeGreens,e.interpolateGreens)],["greys",el(e.schemeGreys,e.interpolateGreys)],["oranges",el(e.schemeOranges,e.interpolateOranges)],["purples",el(e.schemePurples,e.interpolatePurples)],["reds",el(e.schemeReds,e.interpolateReds)],["turbo",ol(e.interpolateTurbo)],["viridis",ol(e.interpolateViridis)],["magma",ol(e.interpolateMagma)],["inferno",ol(e.interpolateInferno)],["plasma",ol(e.interpolatePlasma)],["cividis",ol(e.interpolateCividis)],["cubehelix",ol(e.interpolateCubehelixDefault)],["warm",ol(e.interpolateWarm)],["cool",ol(e.interpolateCool)],["bugn",el(e.schemeBuGn,e.interpolateBuGn)],["bupu",el(e.schemeBuPu,e.interpolateBuPu)],["gnbu",el(e.schemeGnBu,e.interpolateGnBu)],["orrd",el(e.schemeOrRd,e.interpolateOrRd)],["pubu",el(e.schemePuBu,e.interpolatePuBu)],["pubugn",el(e.schemePuBuGn,e.interpolatePuBuGn)],["purd",el(e.schemePuRd,e.interpolatePuRd)],["rdpu",el(e.schemeRdPu,e.interpolateRdPu)],["ylgn",el(e.schemeYlGn,e.interpolateYlGn)],["ylgnbu",el(e.schemeYlGnBu,e.interpolateYlGnBu)],["ylorbr",el(e.schemeYlOrBr,e.interpolateYlOrBr)],["ylorrd",el(e.schemeYlOrRd,e.interpolateYlOrRd)],["rainbow",il(e.interpolateRainbow)],["sinebow",il(e.interpolateSinebow)]]);function el(t,n){return({length:r})=>1===r?[t[3][1]]:2===r?[t[3][1],t[3][2]]:(r=Math.max(3,Math.floor(r)))>9?e.quantize(n,r):t[r]}function nl(t,n){return({length:r})=>2===r?[t[3][0],t[3][2]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize(n,r):t[r]}function rl(t,n){return({length:r})=>2===r?[t[3][2],t[3][0]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize((t=>n(1-t)),r):t[r].slice().reverse()}function ol(t){return({length:n})=>e.quantize(t,Math.max(2,Math.floor(n)))}function il(t){return({length:n})=>e.quantize(t,Math.floor(n)+1).slice(0,-1)}function al(t){const e=`${t}`.toLowerCase();if(!tl.has(e))throw new Error(`unknown ordinal scheme: ${e}`);return tl.get(e)}function ul(t,e){const n=al(t),r="function"==typeof n?n({length:e}):n;return r.length!==e?r.slice(0,e):r}const cl=new Map([["brbg",e.interpolateBrBG],["prgn",e.interpolatePRGn],["piyg",e.interpolatePiYG],["puor",e.interpolatePuOr],["rdbu",e.interpolateRdBu],["rdgy",e.interpolateRdGy],["rdylbu",e.interpolateRdYlBu],["rdylgn",e.interpolateRdYlGn],["spectral",e.interpolateSpectral],["burd",t=>e.interpolateRdBu(1-t)],["buylrd",t=>e.interpolateRdYlBu(1-t)],["blues",e.interpolateBlues],["greens",e.interpolateGreens],["greys",e.interpolateGreys],["purples",e.interpolatePurples],["reds",e.interpolateReds],["oranges",e.interpolateOranges],["turbo",e.interpolateTurbo],["viridis",e.interpolateViridis],["magma",e.interpolateMagma],["inferno",e.interpolateInferno],["plasma",e.interpolatePlasma],["cividis",e.interpolateCividis],["cubehelix",e.interpolateCubehelixDefault],["warm",e.interpolateWarm],["cool",e.interpolateCool],["bugn",e.interpolateBuGn],["bupu",e.interpolateBuPu],["gnbu",e.interpolateGnBu],["orrd",e.interpolateOrRd],["pubugn",e.interpolatePuBuGn],["pubu",e.interpolatePuBu],["purd",e.interpolatePuRd],["rdpu",e.interpolateRdPu],["ylgnbu",e.interpolateYlGnBu],["ylgn",e.interpolateYlGn],["ylorbr",e.interpolateYlOrBr],["ylorrd",e.interpolateYlOrRd],["rainbow",e.interpolateRainbow],["sinebow",e.interpolateSinebow]]);function sl(t){const e=`${t}`.toLowerCase();if(!cl.has(e))throw new Error(`unknown quantitative scheme: ${e}`);return cl.get(e)}const ll=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function fl(t){return null!=t&&ll.has(`${t}`.toLowerCase())}const pl=t=>e=>t(1-e),dl=[0,1],hl=new Map([["number",e.interpolateNumber],["rgb",e.interpolateRgb],["hsl",e.interpolateHsl],["hcl",e.interpolateHcl],["lab",e.interpolateLab]]);function gl(t){const e=`${t}`.toLowerCase();if(!hl.has(e))throw new Error(`unknown interpolator: ${e}`);return hl.get(e)}function ml(t,n,r,{type:o,nice:i,clamp:a,zero:u,domain:c=wl(t,r),unknown:s,round:l,scheme:f,interval:p,range:d=(Vs.get(t)===_s?Ol(r,c):Vs.get(t)===Us?jl(r,c):Vs.get(t)===Ws?dl:void 0),interpolate:h=(Vs.get(t)===Ys?null==f&&void 0!==d?e.interpolateRgb:sl(void 0!==f?f:"cyclical"===o?"rainbow":"turbo"):l?e.interpolateRound:e.interpolateNumber),reverse:g}){if(p=Cs(p),"cyclical"!==o&&"sequential"!==o||(o="linear"),g=!!g,"function"!=typeof h&&(h=gl(h)),1===h.length?(g&&(h=pl(h),g=!1),void 0===d&&2===(d=Float64Array.from(c,((t,e)=>e/(c.length-1)))).length&&(d=dl),n.interpolate((d===dl?$s:xl)(h))):n.interpolate(h),u){const[t,n]=e.extent(c);(t>0||n<0)&&(c=function(t,e=Array){return t instanceof e?t.slice():e.from(t)}(c),zs(c)!==Math.sign(t)?c[c.length-1]=0:c[0]=0)}return g&&(c=e.reverse(c)),n.domain(c).unknown(s),i&&(n.nice(!0===i?void 0:i),c=n.domain()),void 0!==d&&n.range(d),a&&n.clamp(a),{type:o,domain:c,range:d,scale:n,interpolate:h,interval:p}}function yl(t,n,{exponent:r=1,...o}){return ml(t,e.scalePow().exponent(r),n,{...o,type:"pow"})}function vl(t,n,{domain:r=[0],unknown:o,scheme:i="rdylbu",interpolate:a,range:u=(void 0!==a?e.quantize(a,r.length+1):Vs.get(t)===Ys?ul(i,r.length+1):void 0),reverse:c}){const s=zs(ks(r));if(!e.pairs(r).every((([t,n])=>function(t,n,r){const o=e.descending(t,n);return 0===o||o===r}(t,n,s))))throw new Error(`the ${t} scale has a non-monotonic domain`);return c&&(u=e.reverse(u)),{type:"threshold",scale:e.scaleThreshold(s<0?e.reverse(r):r,void 0===u?[]:u).unknown(o),domain:r,range:u}}function bl(t,n=Xs){return t.length?[e.min(t,(({value:t})=>void 0===t?t:e.min(t,n))),e.max(t,(({value:t})=>void 0===t?t:e.max(t,n)))]:[0,1]}function wl(t,e){const n=Vs.get(t);return(n===_s||n===Ws||n===Us?Sl:bl)(e)}function Sl(t){return[0,t.length?e.max(t,(({value:t})=>void 0===t?t:e.max(t,Xs))):1]}function Ol(t,n){const r=t.find((({radius:t})=>void 0!==t));if(void 0!==r)return[0,r.radius];const o=e.quantile(t,.5,(({value:t})=>void 0===t?NaN:e.quantile(t,.25,Zs))),i=n.map((t=>3*Math.sqrt(t/o))),a=30/e.max(i);return a<1?i.map((t=>t*a)):i}function jl(t,n){const r=e.median(t,(({value:t})=>void 0===t?NaN:e.median(t,Math.abs))),o=n.map((t=>12*t/r)),i=60/e.max(o);return i<1?o.map((t=>t*i)):o}function Pl(t){for(const{value:e}of t)if(void 0!==e)for(let n of e){if(n=+n,n>0)return bl(t,Zs);if(n<0)return bl(t,Qs)}return[1,10]}function $l(t){const e=[];for(const{value:n}of t)if(void 0!==n)for(const t of n)e.push(t);return e}function xl(t){return(e,n)=>r=>t(e+r*(n-e))}function Tl(t,n,r,o,{type:i,nice:a,clamp:u,domain:c=bl(o),unknown:s,pivot:l=0,scheme:f,range:p,symmetric:d=!0,interpolate:h=(Vs.get(t)===Ys?null==f&&void 0!==p?e.interpolateRgb:sl(void 0!==f?f:"rdbu"):e.interpolateNumber),reverse:g}){l=+l;let[m,y]=c;if(e.descending(m,y)<0&&([m,y]=[y,m],g=!g),m=Math.min(m,l),y=Math.max(y,l),"function"!=typeof h&&(h=gl(h)),void 0!==p&&(h=1===h.length?xl(h)(...p):e.piecewise(h,p)),g&&(h=pl(h)),d){const t=r.apply(l),e=t-r.apply(m),n=r.apply(y)-t;e<n?m=r.invert(t-n):e>n&&(y=r.invert(t+e))}return n.domain([m,l,y]).unknown(s).interpolator(h),u&&n.clamp(u),a&&n.nice(a),{type:i,domain:[m,y],pivot:l,interpolate:h,scale:n}}function kl(t,n,{exponent:r=1,...o}){return Tl(t,e.scaleDivergingPow().exponent(r=+r),function(t){return.5===t?Cl:{apply:e=>Math.sign(e)*Math.pow(Math.abs(e),t),invert:e=>Math.sign(e)*Math.pow(Math.abs(e),1/t)}}(r),n,{...o,type:"diverging-pow"})}function El(t,n,{constant:r=1,...o}){return Tl(t,e.scaleDivergingSymlog().constant(r=+r),function(t){return{apply:e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),invert:e=>Math.sign(e)*Math.expm1(Math.abs(e))*t}}(r),n,o)}const Rl={apply:t=>t,invert:t=>t},Ml={apply:Math.log,invert:Math.exp},Cl={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function Nl(t,e,n,r){return ml(t,e,n,r)}const Bl=2/Math.sqrt(3),ql={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*Bl,o=r/2;t.moveTo(0,r),t.lineTo(n,o),t.lineTo(n,-o),t.lineTo(0,-r),t.lineTo(-n,-o),t.lineTo(-n,o),t.closePath()}},Dl=new Map([["asterisk",e.symbolAsterisk],["circle",e.symbolCircle],["cross",e.symbolCross],["diamond",e.symbolDiamond],["diamond2",e.symbolDiamond2],["hexagon",ql],["plus",e.symbolPlus],["square",e.symbolSquare],["square2",e.symbolSquare2],["star",e.symbolStar],["times",e.symbolTimes],["triangle",e.symbolTriangle],["triangle2",e.symbolTriangle2],["wye",e.symbolWye]]);function Al(t){return t&&"function"==typeof t.draw}function Il(t){return!!Al(t)||"string"==typeof t&&Dl.has(t.toLowerCase())}function Gl(t){if(null==t||Al(t))return t;const e=Dl.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}const Ll=Symbol("ordinal");function zl(t,n,r,{type:o,interval:i,domain:a,range:u,reverse:c,hint:s}){return i=Cs(i),void 0===a&&(a=_l(r,i,t)),"categorical"!==o&&o!==Ll||(o="ordinal"),c&&(a=e.reverse(a)),n.domain(a),void 0!==u&&("function"==typeof u&&(u=u(a)),n.range(u)),{type:o,domain:a,range:u,scale:n,hint:s,interval:i}}function Fl(t,n,{type:r,interval:o,domain:i,range:a,scheme:u,unknown:c,...s}){let l;if(o=Cs(o),void 0===i&&(i=_l(n,o,t)),Vs.get(t)===Hs)l=function(t){return{fill:Ul(t,"fill"),stroke:Ul(t,"stroke")}}(n),a=void 0===a?function(t){return Ls(t.fill)?e.symbolsStroke:e.symbolsFill}(l):Es(a,Gl);else if(Vs.get(t)===Ys&&(void 0!==a||"ordinal"!==r&&r!==Ll||(a=function(t,e="greys"){const n=new Set,[r,o]=ul(e,2);for(const e of t)if(null!=e)if(!0===e)n.add(o);else{if(!1!==e)return;n.add(r)}return[...n]}(i,u),void 0!==a&&(u=void 0)),void 0===u&&void 0===a&&(u="ordinal"===r?"turbo":"tableau10"),void 0!==u))if(void 0!==a){const t=sl(u),n=a[0],r=a[1]-a[0];a=({length:o})=>e.quantize((e=>t(n+r*e)),o)}else a=al(u);if(c===e.scaleImplicit)throw new Error("implicit unknown is not supported");return zl(t,e.scaleOrdinal().unknown(c),n,{...s,type:r,domain:i,range:a,hint:l})}function Yl(t,e,n,r){let{round:o}=n;return void 0!==o&&t.round(o=!!o),(t=zl(r,t,e,n)).round=o,t}function _l(t,n,r){const o=new e.InternSet;for(const{value:e,domain:n}of t){if(void 0!==n)return n();if(void 0!==e)for(const t of e)o.add(t)}if(void 0!==n){const[t,r]=e.extent(o).map(n.floor,n);return n.range(t,n.offset(r))}if(o.size>1e4&&Vs.get(r)===Fs)throw new Error("implicit ordinal position domain has more than 10,000 values");return e.sort(o,Ks)}function Ul(t,e){let n;for(const{hint:r}of t){const t=r?.[e];if(void 0!==t)if(void 0===n)n=t;else if(n!==t)return}return n}function Wl(t){console.warn(t)}function Hl(t,n,r){return function(t,n=[],r={}){const o=function(t,e,{type:n,domain:r,range:o,scheme:i,pivot:a,projection:u}){if("fx"===t||"fy"===t)return"band";"x"!==t&&"y"!==t||null==u||(n=Jl);for(const{type:t}of e)if(void 0!==t)if(void 0===n)n=t;else if(n!==t)throw new Error(`scale incompatible with channel: ${n} !== ${t}`);if(n===Jl)return;if(void 0!==n)return n;if(void 0===r&&!e.some((({value:t})=>void 0!==t)))return;const c=Vs.get(t);if(c===Ys&&void 0===o&&void 0===i&&Xl(r,e,Gs))return"identity";if(c===Hs&&void 0===o&&Xl(r,e,Il))return"identity";if(c===_s)return"sqrt";if(c===Ws||c===Us)return"linear";if(c===Hs)return"ordinal";if((r||o||[]).length>2)return Kl(c);if(void 0!==r)return Ns(r)?Kl(c):Bs(r)?"utc":c!==Ys||null==a&&!fl(i)?"linear":"diverging";const s=e.map((({value:t})=>t)).filter((t=>void 0!==t));return s.some(Ns)?Kl(c):s.some(Bs)?"utc":c!==Ys||null==a&&!fl(i)?"linear":"diverging"}(t,n,r);if(void 0===r.type&&void 0===r.domain&&void 0===r.range&&null==r.interval&&"fx"!==t&&"fy"!==t&&Zl({type:o})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some(Bs)?Wl(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${Vl(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${Vl(o)}".`):e.some(qs)?Wl(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${Vl(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${Vl(o)}".`):e.some(Ds)&&Wl(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${Vl(o)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${Vl(o)}".`)}switch(r.type=o,o){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":r=Ql(n,r,nf);break;case"identity":switch(Vs.get(t)){case Fs:r=Ql(n,r,nf);break;case Hs:r=Ql(n,r,tf)}break;case"utc":case"time":r=Ql(n,r,ef)}switch(o){case"diverging":return function(t,n,r){return Tl(t,e.scaleDiverging(),Rl,n,r)}(t,n,r);case"diverging-sqrt":return function(t,e,n){return kl(t,e,{...n,exponent:.5})}(t,n,r);case"diverging-pow":return kl(t,n,r);case"diverging-log":return function(t,n,{base:r=10,pivot:o=1,domain:i=bl(n,o<0?Qs:Zs),...a}){return Tl(t,e.scaleDivergingLog().base(r=+r),Ml,n,{domain:i,pivot:o,...a})}(t,n,r);case"diverging-symlog":return El(t,n,r);case"categorical":case"ordinal":case Ll:return Fl(t,n,r);case"cyclical":case"sequential":case"linear":return function(t,n,r){return ml(t,e.scaleLinear(),n,r)}(t,n,r);case"sqrt":return function(t,e,n){return yl(t,e,{...n,exponent:.5})}(t,n,r);case"threshold":return vl(t,0,r);case"quantile":return function(t,n,{range:r,quantiles:o=(void 0===r?5:(r=[...r]).length),n:i=o,scheme:a="rdylbu",domain:u=$l(n),interpolate:c,reverse:s}){return void 0===r&&(r=void 0!==c?e.quantize(c,i):Vs.get(t)===Ys?ul(a,i):void 0),u.length>0&&(u=e.scaleQuantile(u,void 0===r?{length:i}:r).quantiles()),vl(t,0,{domain:u,range:r,reverse:s})}(t,n,r);case"quantize":return function(t,n,{range:r,n:o=(void 0===r?5:(r=[...r]).length),scheme:i="rdylbu",domain:a=wl(t,n),unknown:u,interpolate:c,reverse:s}){const[l,f]=e.extent(a);let p;return void 0===r?(p=e.ticks(l,f,o),p[0]<=l&&p.splice(0,1),p[p.length-1]>=f&&p.pop(),o=p.length+1,r=void 0!==c?e.quantize(c,o):Vs.get(t)===Ys?ul(i,o):void 0):(p=e.quantize(e.interpolateNumber(l,f),o+1).slice(1,-1),l instanceof Date&&(p=p.map((t=>new Date(t))))),zs(ks(a))<0&&p.reverse(),vl(t,0,{domain:p,range:r,reverse:s,unknown:u})}(t,n,r);case"pow":return yl(t,n,r);case"log":return function(t,n,{base:r=10,domain:o=Pl(n),...i}){return ml(t,e.scaleLog().base(r),n,{...i,domain:o})}(t,n,r);case"symlog":return function(t,n,{constant:r=1,...o}){return ml(t,e.scaleSymlog().constant(r),n,o)}(t,n,r);case"utc":return function(t,n,r){return Nl(t,e.scaleUtc(),n,r)}(t,n,r);case"time":return function(t,n,r){return Nl(t,e.scaleTime(),n,r)}(t,n,r);case"point":return function(t,n,{align:r=.5,padding:o=.5,...i}){return Yl(e.scalePoint().align(r).padding(o),n,i,t)}(t,n,r);case"band":return function(t,n,{align:r=.5,padding:o=.1,paddingInner:i=o,paddingOuter:a=("fx"===t||"fy"===t?0:o),...u}){return Yl(e.scaleBand().align(r).paddingInner(i).paddingOuter(a),n,u,t)}(t,n,r);case"identity":return Vs.get(t)===Fs?{type:"identity",scale:e.scaleIdentity()}:{type:"identity"};case void 0:return;default:throw new Error(`unknown scale type: ${o}`)}}(t,void 0===r?void 0:[{hint:r}],{...n})}function Vl(t){return"symbol"==typeof t?t.description:t}const Jl={toString:()=>"projection"};function Kl(t){switch(t){case Fs:return"point";case Ys:return Ll;default:return"ordinal"}}function Xl(t,e,n){return void 0!==t?As(t,n)&&Is(t,n):e.some((({value:t})=>void 0!==t&&As(t,n)))&&e.every((({value:t})=>void 0===t||Is(t,n)))}function Zl({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===Ll}function Ql(t,{domain:e,...n},r){for(const e of t)void 0!==e.value&&(e.value=r(e.value));return{domain:void 0===e?e:r(e),...n}}function tf(t){return Es(t,Gl)}function ef(t){return Es(t,of)}function nf(t){return function(t){return t instanceof Os}(t)?t:Es(t,rf,Float64Array)}function rf(t){return null==t?NaN:+t}function of(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?ws(t):null==t||isNaN(t=+t)?void 0:new Date(t)}const af=Math.PI,uf=2*af;function cf({projection:t,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n}={},u){if(null==t)return;if("function"==typeof t.stream)return t;let c,s,l="frame";if(Rs(t)){let e;if(({type:t,domain:s,inset:e,insetTop:r=(void 0!==e?e:r),insetRight:o=(void 0!==e?e:o),insetBottom:i=(void 0!==e?e:i),insetLeft:a=(void 0!==e?e:a),clip:l=l,...c}=t),null==t)return}"function"!=typeof t&&({type:t}=function(t){switch(`${t}`.toLowerCase()){case"albers-usa":return sf(e.geoAlbersUsa,.7463,.4673);case"albers":return lf(e.geoAlbers,.7463,.4673);case"azimuthal-equal-area":return sf(e.geoAzimuthalEqualArea,4,4);case"azimuthal-equidistant":return sf(e.geoAzimuthalEquidistant,uf,uf);case"conic-conformal":return lf(e.geoConicConformal,uf,uf);case"conic-equal-area":return lf(e.geoConicEqualArea,6.1702,2.9781);case"conic-equidistant":return lf(e.geoConicEquidistant,7.312,3.6282);case"equal-earth":return sf(e.geoEqualEarth,5.4133,2.6347);case"equirectangular":return sf(e.geoEquirectangular,uf,af);case"gnomonic":return sf(e.geoGnomonic,3.4641,3.4641);case"identity":return{type:ff};case"reflect-y":return{type:pf};case"mercator":return sf(e.geoMercator,uf,uf);case"orthographic":return sf(e.geoOrthographic,2,2);case"stereographic":return sf(e.geoStereographic,2,2);case"transverse-mercator":return sf(e.geoTransverseMercator,uf,uf);default:throw new Error(`unknown projection type: ${t}`)}}(t));const{width:f,height:p,marginLeft:d,marginRight:h,marginTop:g,marginBottom:m}=u,y=f-d-h-a-o,v=p-g-m-r-i;if(t=t?.({width:y,height:v,clip:l,...c}),null==t)return;l=function(t,n,r,o,i){if(!1===t||null==t||"number"==typeof t)return t=>t;!0===t&&(t="frame");if("frame"===`${t}`.toLowerCase())return e.geoClipRectangle(n,r,o,i);throw new Error(`unknown projection clip type: ${t}`)}(l,d,g,f-h,p-m);let b,w=d+a,S=g+r;if(null!=s){const[[n,r],[o,i]]=e.geoPath(t).bounds(s),a=Math.min(y/(o-n),v/(i-r));a>0?(w-=(a*(n+o)-y)/2,S-=(a*(r+i)-v)/2,b=e.geoTransform({point(t,e){this.stream.point(t*a+w,e*a+S)}})):Wl("Warning: the projection could not be fit to the specified domain; using the default scale.")}return b??=0===w&&0===S?ff():e.geoTransform({point(t,e){this.stream.point(t+w,e+S)}}),{stream:e=>t.stream(b.stream(l(e)))}}function sf(t,e,n){return{type:({width:r,height:o,rotate:i,precision:a=.15,clip:u})=>{const c=t();return null!=a&&c.precision?.(a),null!=i&&c.rotate?.(i),"number"==typeof u&&c.clipAngle?.(u),c.scale(Math.min(r/e,o/n)),c.translate([r/2,o/2]),c},aspectRatio:n/e}}function lf(t,e,n){const{type:r,aspectRatio:o}=sf(t,e,n);return{type:t=>{const{parallels:e,domain:n,width:o,height:i}=t,a=r(t);return null!=e&&(a.parallels(e),void 0===n&&a.fitSize([o,i],{type:"Sphere"})),a},aspectRatio:o}}const ff=$s({stream:t=>t}),pf=$s(e.geoTransform({point(t,e){this.stream.point(t,-e)}}));function df(t={},e){const{document:n=("undefined"!=typeof window?window.document:void 0)}=t;return{document:n,projection:cf(t,e)}}function hf(t,{document:n}){return e.select(e.creator(t).call(n.documentElement))}const gf=function(t){let e,n;return(...r)=>((n?.length!==r.length||n.some(((t,e)=>t!==r[e])))&&(n=r,e=t(...r)),e)}((t=>new Intl.NumberFormat(t)));function mf(t){return ys(t,"Invalid Date")}function yf(t,e){if((t=Ps(t))!==e)return t}!function(t="en-US"){const e=function(t="en-US"){const e=gf(t);return t=>null==t||isNaN(t)?void 0:e.format(t)}(t)}();const vf=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/;function bf(t){if(void 0===t)return`plot-${Math.random().toString(16).slice(2)}`;if(t=`${t}`,!vf.test(t))throw new Error(`invalid class name: ${t}`);return t}function wf(t,e){if("string"==typeof e)t.property("style",e);else if(null!=e)for(const n of t)Object.assign(n.style,e)}function Sf(t){return Zl(t)&&void 0===t.interval?void 0:"tabular-nums"}function Of(t,e){if(null==e)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function jf(t,n={},r,o){let{columns:i,tickFormat:a,fontVariant:u=Sf(t),swatchSize:c=15,swatchWidth:s=c,swatchHeight:l=c,marginLeft:f=0,className:p,style:d,width:h}=n;const g=df(n);p=bf(p),a=function(t,n){return void 0===t?Bs(n)?mf:Ps:"function"==typeof t?t:("string"==typeof t?Bs(n)?e.utcFormat:e.format:$s)(t)}(a,t.domain);const m=hf("div",g).attr("class",p).attr("style",`\n        --swatchWidth: ${+s}px;\n        --swatchHeight: ${+l}px;\n      `);let y;return null!=i?(y=`\n      .${p}-swatch {\n        display: flex;\n        align-items: center;\n        break-inside: avoid;\n        padding-bottom: 1px;\n      }\n      .${p}-swatch::before {\n        flex-shrink: 0;\n      }\n      .${p}-label {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n    `,m.style("columns",i).selectAll().data(t.domain).enter().append("div").attr("class",`${p}-swatch`).call(r,t).call((t=>t.append("div").attr("class",`${p}-label`).attr("title",a).text(a)))):(y=`\n      .${p} {\n        display: flex;\n        align-items: center;\n        min-height: 33px;\n        flex-wrap: wrap;\n      }\n      .${p}-swatch {\n        display: inline-flex;\n        align-items: center;\n        margin-right: 1em;\n      }\n    `,m.selectAll().data(t.domain).enter().append("span").attr("class",`${p}-swatch`).call(r,t).append((function(){return this.ownerDocument.createTextNode(a.apply(this,arguments))}))),m.call((t=>t.insert("style","*").text(`\n        .${p} {\n          font-family: system-ui, sans-serif;\n          font-size: 10px;\n          margin-bottom: 0.5em;${void 0===f?"":`\n          margin-left: ${+f}px;`}${void 0===h?"":`\n          width: ${h}px;`}\n        }\n        ${o(p)}\n        ${y}\n      `))).style("font-variant",yf(u,"normal")).call(wf,d).node()}const Pf=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:r=1,stroke:o=(void 0!==t.hint?.stroke?t.hint.stroke:Ls(n)?"currentColor":"none"),strokeOpacity:i=1,strokeWidth:a=1.5,r:u=4.5,...c}={},s){const[l,f]=xs(n),[p,d]=xs(o),h=Of(s,l),g=Of(s,p),m=u*u*Math.PI;return r=Ts(r)[1],i=Ts(i)[1],a=Ts(a)[1],jf(t,c,(n=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("fill","color"===l?t=>h.scale(t):null).attr("stroke","color"===p?t=>g.scale(t):null).append("path").attr("d",(n=>{const r=e.pathRound();return t.scale(n).draw(r,m),r}))),(t=>`.${t}-swatch > svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n        overflow: visible;\n        fill: ${f};\n        fill-opacity: ${r};\n        stroke: ${d};\n        stroke-width: ${a}px;\n        stroke-opacity: ${i};\n      }`))}],["color",xf],["opacity",function({type:t,interpolate:n,...r},{legend:o=!0,color:i=e.rgb(0,0,0),...a}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===o&&(o="ramp");if("ramp"!==`${o}`.toLowerCase())throw new Error(`${o} opacity legends are not supported`);return xf({type:t,...r,interpolate:Tf(i)},{legend:o,...a})}]]);function $f(t,{label:e,ticks:n,tickFormat:r}={},o){return function(t={},...e){let n=t;for(const r of e)for(const e in r)if(void 0===n[e]){const o=r[e];n===t?n={...n,[e]:o}:n[e]=o}return n}(o,t,{label:e,ticks:n,tickFormat:r})}function xf(t,{legend:n=!0,...r}){if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${n}`.toLowerCase()){case"swatches":return function(t,e){if(!Zl(t)&&!function({type:t}){return"threshold"===t}(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return jf(t,e,((t,e)=>t.append("svg").attr("fill",e.scale).append("rect").attr("width","100%").attr("height","100%")),(t=>`.${t}-swatch svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n      }`))}(t,r);case"ramp":return function(t,n){let{label:r=t.label,tickSize:o=6,width:i=240,height:a=44+o,marginTop:u=18,marginRight:c=0,marginBottom:s=16+o,marginLeft:l=0,style:f,ticks:p=(i-l-c)/64,tickFormat:d,fontVariant:h=Sf(t),round:g=!0,className:m}=n;const y=df(n);m=bf(m),null===d&&(d=()=>null);const v=hf("svg",y).attr("class",m).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",a).attr("viewBox",`0 0 ${i} ${a}`).call((t=>t.append("style").text(`\n        .${m} {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n          overflow: visible;\n        }\n        .${m} text {\n          white-space: pre;\n        }\n      `))).call(wf,f);let b,w=t=>t.selectAll(".tick line").attr("y1",u+s-a);const S=g?(t,e)=>t.rangeRound(e):(t,e)=>t.range(e),{type:O,domain:j,range:P,interpolate:$,scale:x,pivot:T}=t;if($){const t=void 0===P?$:e.piecewise(1===$.length?xl($):$,P);b=S(x.copy(),e.quantize(e.interpolateNumber(l,i-c),Math.min(j.length+(void 0!==T),void 0===P?1/0:P.length)));const n=256,r=y.document.createElement("canvas");r.width=n,r.height=1;const o=r.getContext("2d");for(let e=0,r=n-1;e<n;++e)o.fillStyle=t(e/r),o.fillRect(e,0,1,1);v.append("image").attr("x",l).attr("y",u).attr("width",i-l-c).attr("height",a-u-s).attr("preserveAspectRatio","none").attr("xlink:href",r.toDataURL())}else if("threshold"===O){const t=j,n=void 0===d?t=>t:"string"==typeof d?e.format(d):d;b=S(e.scaleLinear().domain([-1,P.length-1]),[l,i-c]),v.append("g").selectAll().data(P).enter().append("rect").attr("x",((t,e)=>b(e-1))).attr("y",u).attr("width",((t,e)=>b(e)-b(e-1))).attr("height",a-u-s).attr("fill",(t=>t)),p=Es(t,((t,e)=>e)),d=e=>n(t[e],e)}else b=S(e.scaleBand().domain(j),[l,i-c]),v.append("g").selectAll().data(j).enter().append("rect").attr("x",b).attr("y",u).attr("width",Math.max(0,b.bandwidth()-1)).attr("height",a-u-s).attr("fill",x),w=()=>{};return v.append("g").attr("transform",`translate(0,${a-s})`).call(e.axisBottom(b).ticks(Array.isArray(p)?null:p,"string"==typeof d?d:void 0).tickFormat("function"==typeof d?d:void 0).tickSize(o).tickValues(Array.isArray(p)?p:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",yf(h,"normal")).call(w).call((t=>t.select(".domain").remove())),void 0!==r&&v.append("text").attr("x",l).attr("y",u-6).attr("fill","currentColor").attr("font-weight","bold").text(r),v.node()}(t,r);default:throw new Error(`unknown legend type: ${n}`)}}function Tf(t){const{r:n,g:r,b:o}=e.rgb(t)||e.rgb(0,0,0);return t=>`rgba(${n},${r},${o},${t})`}var kf=".graph-legend",Ef={enabled:!0,itemSelector:null,label:null,width:130},Rf=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="Legend",this.calendar=t,this.root=null,this.shown=!1,this.options=Ef}var o,i,a;return o=e,i=[{key:"setup",value:function(t){this.options=Object.assign(Object.assign({},Ef),t)}},{key:"paint",value:function(){var e=this.calendar.options.options.scale,n=this.options,o=n.enabled,i=n.itemSelector;if(!o||i&&t.select(i).empty())return this.destroy();this.shown=!0,this.root=t.select(i||this.calendar.options.options.itemSelector),this.root.select(kf).empty()?this.root=this.root.append("svg").attr("class",kf.slice(1)):this.root=this.root.select(kf);var a,u,c,s=function(t={}){for(const[e,n]of Pf){const r=t[e];if(Ms(r)){const o=df(t);let i;if("symbol"===e){const{fill:e,stroke:n=(void 0===e&&Ms(t.color)?"color":void 0)}=t;i={fill:e,stroke:n}}return n(Hl(e,r,i),$f(o,r,t),(e=>Ms(t[e])?Hl(e,t[e]):null))}}throw new Error("unknown legend type; no scale found")}(Object.assign((a={},u=e.as,c=e,(u=r(u))in a?Object.defineProperty(a,u,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[u]=c,a),this.options));return this.root.selectAll("*").remove(),this.root.append((function(){return s})),Promise.resolve()}},{key:"destroy",value:function(){return null!==this.root&&(this.root.remove(),this.root=null),Promise.resolve()}}],i&&n(o.prototype,i),a&&n(o,a),Object.defineProperty(o,"prototype",{writable:!1}),e}();return Rf}));//# sourceMappingURL=Legend.min.js.map
